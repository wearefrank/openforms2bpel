<Module>
    <Adapter name="Register"
             description="">

        <Receiver name="Register">
            <JavaListener name="StartRegisterProcess"/>
        </Receiver>

        <Pipeline>

            <SoapInputWrapper direction="unwrap"
                                 removeOutputNamespaces="true"
                                 storeResultInSessionKey="originalMessage" />


<!--            Xslt -->

            <SoapOutputWrapper>
                <param name="errorCode" sessionKey="errorCode"/>
                <param name="errorReason" sessionKey="errorReason"/>
            </SoapOutputWrapper>

            <WebServiceSender name="SendRegisterProcess" url="${openforms2bpel.registerEndpoint}">
                <Param name="soapAction" value=""/>

                <WsdlXmlInputValidator
                        schemaLocation="xsd/Register.xsd"
                        soapBody="RegisterRequestMessage"
                        soapVersion="auto"
                        ignoreUnknownNamespaces="true">
                    <Forward name="failure" path="EXIT"/>
                    <Forward name="parserError" path="EXIT"/>
                </WsdlXmlInputValidator>

                <WsdlXmlOutputValidator
                        schemaLocation="xsd/Register.xsd"
                        soapBody="RegisterResponseMessage"
                        soapVersion="auto"
                        ignoreUnknownNamespaces="true">
                    <Forward name="failure" path="EXIT"/>
                    <Forward name="parserError" path="EXIT"/>
                </WsdlXmlOutputValidator>

                <Forward name="success" path="EXIT" />
            </WebServiceSender>


<!--            <SenderPipe-->
<!--                    name="SendBackRegisterResponse">-->
<!--                <IbisLocalSender-->
<!--                        name="RegisterSender"-->
<!--                        javaListener="RegisterResponse">-->
<!--                    <Param name="RegisterResponseValue" sessionKey="originalMessage"/>-->
<!--                </IbisLocalSender>-->
<!--                <Forward name="success" path="EXIT"/>-->
<!--                <Forward name="exception" path="EXCEPTION" />-->
<!--            </SenderPipe>-->

            <Exit name="EXIT" state="success"/>

        </Pipeline>
    </Adapter>
</Module>